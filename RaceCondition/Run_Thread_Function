
void run_thread(int *param_1)

{
  int iVar1;
  char *__haystack;
  char *pcVar2;
  long in_FS_OFFSET;
  char local_218 [520];
  undefined8 local_10;
  
  local_10 = *(undefined8 *)(in_FS_OFFSET + 0x28);
  if (param_1 == (int *)0x0) {
                    /* WARNING: Subroutine does not return */
    pthread_exit((void *)0x0);
  }
  __haystack = (char *)malloc(0x401);
  __haystack[0x400] = '\0';
  read(*param_1,__haystack,0x400);
  pcVar2 = strstr(__haystack,"deposit");
  if (pcVar2 == (char *)0x0) {
    pcVar2 = strstr(__haystack,"withdraw");
    if (pcVar2 == (char *)0x0) {
      pcVar2 = strstr(__haystack,"purchase flag");
      if (pcVar2 != (char *)0x0) {
        if ((int)money < 200) {
          write(*param_1,"Sorry, you don\'t have enough money to purchase the flag\n",0x38);
        }
        else {
          iVar1 = open("/flag",0);
          sendfile(*param_1,iVar1,(off_t *)0x0,0x80);
          money = money - 200;
        }
      }
    }
    else {
      money = money - 100;
    }
  }
  else {
    money = money + 100;
  }
  iVar1 = snprintf(local_218,0x400,"Current balance: %d\n",(ulong)money);
  write(*param_1,local_218,(long)iVar1);
  usleep(1);
  money = 0;
  close(*param_1);
  free(__haystack);
  free(param_1);
                    /* WARNING: Subroutine does not return */
  pthread_exit((void *)0x0);
}

